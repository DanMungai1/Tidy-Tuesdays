labs(
title = "<span style = 'font-size:18pt'><b>The Great One Could *Pass*</b><br><span style = 'font-size:15pt'>Current NHL star <span style = 'color:#F8766D;'>**Alex Ovechkin**</span> just scored his 700th career goal, approaching hockey legend <span style = 'color:#00BFC4;'>**Wayne Gretzky**</span>'s total goals record of 894. But when we look at total accumulated  **points** (goals + assists), no one past or present can touch Gretzky.", x= "Age", y = "") +
theme(
plot.title.position = "plot",
plot.title = element_textbox_simple(
size = 13,
lineheight = 1,
padding = margin(5.5, 5.5, 5.5, 5.5),
margin = margin(0, 0, 5.5, 0),
fill = NULL
))+
theme(text = element_text(size=15, family = "Helvetica"))+
theme(strip.background = element_rect(color="black", size=1, linetype="solid"))+
theme(legend.position = "none")
Goal_Age
ggsave("NHL.png", dpi = 300, width = 9.5, height = 8.5, units = "in")
Goal_Age <- ggplot()+
geom_line(player_cumulative, mapping = aes(x=age, y=value, color = player), size = 1.25)+
facet_wrap(~metric)+
gghighlight(player == "Wayne Gretzky" | player == "Alex Ovechkin"	, calculate_per_facet = TRUE, use_direct_label = FALSE)+
theme_minimal()+
labs(
title = "<span style = 'font-size:20pt'><b>The Great One Could *Pass*</b><br><span style = 'font-size:16pt'>Current NHL star <span style = 'color:#F8766D;'>**Alex Ovechkin**</span> just scored his 700th career goal, approaching hockey legend <span style = 'color:#00BFC4;'>**Wayne Gretzky**</span>'s total goals record of 894. But when we look at total accumulated  **points** (goals + assists), no one past or present can touch Gretzky.", x= "Age", y = "") +
theme(
plot.title.position = "plot",
plot.title = element_textbox_simple(
size = 13,
lineheight = 1,
padding = margin(5.5, 5.5, 5.5, 5.5),
margin = margin(0, 0, 5.5, 0),
fill = NULL
))+
theme(text = element_text(size=16, family = "Helvetica"))+
theme(strip.background = element_rect(color="black", size=1, linetype="solid"))+
theme(legend.position = "none")
Goal_Age
ggsave("NHL.png", dpi = 300, width = 9.5, height = 8.5, units = "in")
Goal_Age <- ggplot()+
geom_line(player_cumulative, mapping = aes(x=age, y=value, color = player), size = 1.25)+
facet_wrap(~metric)+
gghighlight(player == "Wayne Gretzky" | player == "Alex Ovechkin"	, calculate_per_facet = TRUE, use_direct_label = FALSE)+
theme_minimal()+
labs(
title = "<span style = 'font-size:20pt'><b>The Great One Could *Pass*</b><br><span style = 'font-size:16pt'>Current NHL star <span style = 'color:#F8766D;'>**Alex Ovechkin**</span> just scored his 700th career goal, approaching hockey legend <span style = 'color:#00BFC4;'>**Wayne Gretzky**</span>'s total goals record of 894. But when we look at total accumulated  **points** (goals + assists), no one past or present can touch Gretzky.", x= "Age", y = "") +
theme(
plot.title.position = "plot",
plot.title = element_textbox_simple(
size = 13,
lineheight = 1,
padding = margin(5.5, 5.5, 5.5, 5.5),
margin = margin(0, 0, 5.5, 0),
fill = NULL
))+
theme(text = element_text(size=18, family = "Helvetica"))+
theme(strip.background = element_rect(color="black", size=1, linetype="solid"))+
theme(legend.position = "none")
Goal_Age
ggsave("NHL.png", dpi = 300, width = 9.5, height = 8.5, units = "in")
Goal_Age <- ggplot()+
geom_line(player_cumulative, mapping = aes(x=age, y=value, color = player), size = 1.25)+
facet_wrap(~metric)+
gghighlight(player == "Wayne Gretzky" | player == "Alex Ovechkin"	, calculate_per_facet = TRUE, use_direct_label = FALSE)+
theme_minimal()+
labs(
title = "<span style = 'font-size:20pt'><b>The Great One Could *Pass*</b><br><span style = 'font-size:16pt'>Current NHL star <span style = 'color:#F8766D;'>**Alex Ovechkin**</span> just scored his 700th career goal, approaching hockey legend <span style = 'color:#00BFC4;'>**Wayne Gretzky**</span>'s total goals record of 894. But when we look at total accumulated  **points** (goals + assists), no one past or present can touch Gretzky.", x= "Age", y = "") +
theme(
plot.title.position = "plot",
plot.title = element_textbox_simple(
size = 13,
lineheight = 1,
padding = margin(5.5, 5.5, 5.5, 5.5),
margin = margin(0, 0, 5.5, 0),
fill = NULL
))+
theme(text = element_text(size=18, family = "Helvetica"))+
theme(strip.background = element_rect(color="black", size=2, linetype="solid"))+
theme(legend.position = "none")
Goal_Age
Goal_Age <- ggplot()+
geom_line(player_cumulative, mapping = aes(x=age, y=value, color = player), size = 1.25)+
facet_wrap(~metric)+
gghighlight(player == "Wayne Gretzky" | player == "Alex Ovechkin"	, calculate_per_facet = TRUE, use_direct_label = FALSE)+
theme_minimal()+
labs(
title = "<span style = 'font-size:20pt'><b>The Great One Could *Pass*</b><br><span style = 'font-size:16pt'>Current NHL star <span style = 'color:#F8766D;'>**Alex Ovechkin**</span> just scored his 700th career goal, approaching hockey legend <span style = 'color:#00BFC4;'>**Wayne Gretzky**</span>'s total goals record of 894. But when we look at total accumulated  **points** (goals + assists), no one past or present can touch Gretzky.", x= "Age", y = "", caption = "Gray lines represent top 250 NHL Goal Scorers\nData Washington Post | #TidyTuesday | @Ian_Bellio") +
theme(
plot.title.position = "plot",
plot.title = element_textbox_simple(
size = 13,
lineheight = 1,
padding = margin(5.5, 5.5, 5.5, 5.5),
margin = margin(0, 0, 5.5, 0),
fill = NULL
))+
theme(text = element_text(size=18, family = "Helvetica"))+
theme(strip.background = element_rect(color="black", size=1.25, linetype="solid"), )+
theme(legend.position = "none")
Goal_Age
ggsave("NHL.png", dpi = 300, width = 9.5, height = 8.5, units = "in")
Goal_Age <- ggplot()+
geom_line(player_cumulative, mapping = aes(x=age, y=value, color = player), size = 1.25)+
facet_wrap(~metric)+
gghighlight(player == "Wayne Gretzky" | player == "Alex Ovechkin"	, calculate_per_facet = TRUE, use_direct_label = FALSE)+
theme_minimal()+
labs(
title = "<span style = 'font-size:20pt'><b>The Great One Could *Pass*</b><br><span style = 'font-size:16pt'>Current NHL star <span style = 'color:#F8766D;'>**Alex Ovechkin**</span> just scored his 700th career goal, approaching hockey legend <span style = 'color:#00BFC4;'>**Wayne Gretzky**</span>'s total goals record of 894. But when we look at total accumulated  **points** (goals + assists), no one past or present can touch Gretzky.", x= "Age", y = "", caption = "<span style = 'font-size:14pt'>Gray lines represent top 250 NHL Goal Scorers\nData: Washington Post • #TidyTuesday • @Ian_Bellio</span>") +
theme(
plot.title.position = "plot",
plot.title = element_textbox_simple(
size = 13,
lineheight = 1,
padding = margin(5.5, 5.5, 5.5, 5.5),
margin = margin(0, 0, 5.5, 0),
fill = NULL
))+
theme(text = element_text(size=18, family = "Helvetica"))+
theme(strip.background = element_rect(color="black", size=1.25, linetype="solid"), )+
theme(legend.position = "none")
Goal_Age
Goal_Age <- ggplot()+
geom_line(player_cumulative, mapping = aes(x=age, y=value, color = player), size = 1.25)+
facet_wrap(~metric)+
gghighlight(player == "Wayne Gretzky" | player == "Alex Ovechkin"	, calculate_per_facet = TRUE, use_direct_label = FALSE)+
theme_minimal()+
labs(
title = "<span style = 'font-size:20pt'><b>The Great One Could *Pass*</b><br><span style = 'font-size:16pt'>Current NHL star <span style = 'color:#F8766D;'>**Alex Ovechkin**</span> just scored his 700th career goal, approaching hockey legend <span style = 'color:#00BFC4;'>**Wayne Gretzky**</span>'s total goals record of 894. But when we look at total accumulated  **points** (goals + assists), no one past or present can touch Gretzky.", x= "Age", y = "", caption = "<span style = 'font-size:14pt'>Gray lines represent top 250 NHL Goal Scorers\nData: Washington Post • #TidyTuesday • @Ian_Bellio</span>") +
theme(
plot.title.position = "plot",
plot.title = element_textbox_simple(
size = 13,
lineheight = 1,
padding = margin(5.5, 5.5, 5.5, 5.5),
margin = margin(0, 0, 5.5, 0),
fill = NULL
))+
theme(text = element_text(size=18, family = "Helvetica"))+
theme(strip.background = element_rect(color="black", size=1.25, linetype="solid"), )+
theme(legend.position = "none")+
theme(plot.caption = element_text(size = 15))
Goal_Age
Goal_Age <- ggplot()+
geom_line(player_cumulative, mapping = aes(x=age, y=value, color = player), size = 1.25)+
facet_wrap(~metric)+
gghighlight(player == "Wayne Gretzky" | player == "Alex Ovechkin"	, calculate_per_facet = TRUE, use_direct_label = FALSE)+
theme_minimal()+
labs(
title = "<span style = 'font-size:20pt'><b>The Great One Could *Pass*</b><br><span style = 'font-size:16pt'>Current NHL star <span style = 'color:#F8766D;'>**Alex Ovechkin**</span> just scored his 700th career goal, approaching hockey legend <span style = 'color:#00BFC4;'>**Wayne Gretzky**</span>'s total goals record of 894. But when we look at total accumulated  **points** (goals + assists), no one past or present can touch Gretzky.", x= "Age", y = "", caption = "Gray lines represent top 250 NHL Goal Scorers\nData: Washington Post • #TidyTuesday • @Ian_Bellio") +
theme(
plot.title.position = "plot",
plot.title = element_textbox_simple(
size = 13,
lineheight = 1,
padding = margin(5.5, 5.5, 5.5, 5.5),
margin = margin(0, 0, 5.5, 0),
fill = NULL
))+
theme(text = element_text(size=18, family = "Helvetica"))+
theme(strip.background = element_rect(color="black", size=1.25, linetype="solid"), )+
theme(legend.position = "none")+
theme(plot.caption = element_text(size = 12))
Goal_Age
ggsave("NHL.png", dpi = 300, width = 9.5, height = 8.5, units = "in")
ggsave("NHL.png", dpi = 300, width = 9.5, height = 6.5, units = "in")
ggsave("NHL.png", dpi = 300, width = 9.5, height = 6.5, units = "in")
vb_matches <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-19/vb_matches.csv', guess_max = 76000)
View(vb_matches)
library(tidyverse)
vb_usa <- vb_matches %>%
pivot_longer(cols = c("w_player1"))
View(vb_usa)
vb_usa <- vb_matches %>%
select(cols = c("w_player1"))
View(vb_usa)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate"))
View(vb_usa)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country"))
View(vb_usa)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
pivot_longer(cols = c("w_player1","w_player2", "l_player1", "l_player2" ), names_to = "name", values_to = "birthdate")
View(vb_usa)
pivot
vignette("pivot")
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
pivot_longer(names_to = "name", values_to = "birthdate")
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
pivot_longer(cols = ALL, names_to = "name", values_to = "birthdate")
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
pivot_longer(cols = everything(), names_to = "name", values_to = "birthdate")
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
pivot_longer(cols = everything(), names_to = c(".birthday", "player"), names_sep = "_", values_drop_na = TRUE)
View(vb_usa)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
pivot_longer(cols = everything(), names_to = c(".value", "player"), names_sep = "_", values_drop_na = TRUE)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
pivot_longer(cols = everything(), names_to = c(".value", "player", "birthdate"), names_sep = "_", values_drop_na = TRUE)
View(vb_usa)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
pivot_longer(cols = everything(), names_to = c(".value", "player", "birthdate"), names_sep = "_")
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c("w_player1" = "player1", "w_player2" = "player2","l_player1" = "player3","l_player2" = "player4"))
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2"))
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2")) %>%
pivot_longer(cols = everything(), names_to = c(".value", "player"), names_sep = "player")
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2")) %>%
pivot_longer(cols = everything(), names_to = c(".value", "player"), names_sep = "player", values_drop_na = TRUE)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2")) %>%
pivot_longer(cols = everything(), names_to = c"player", names_sep = "player", values_drop_na = TRUE)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(, c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2")) %>%
pivot_longer(cols = everything(), names_to = "player", names_sep = "player", values_drop_na = TRUE)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(, c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2")) %>%
pivot_longer(cols = everything(), names_to = "player", values_drop_na = TRUE)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player" = "w_player1", "player"="w_player2" ,"player" ="l_player1" ,"player"="l_player2")) %>%
pivot_longer(cols = everything(), names_to = "player", values_drop_na = TRUE)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2"))
View(vb_usa)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2")) %>%
group_by(c("player1", "player2", "player3", "player4"))
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2")) %>%
group_by(player1, player2, player3, player4)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2")) %>%
group_by(player1, player2, player3, player4) %>%
mutate(ind = row_number)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2")) %>%
group_by(player1, player2, player3, player4) %>%
mutate("ind" = row_number)
View(vb_usa)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2")) %>%
group_by(player1, player2, player3, player4) %>%
mutate(sequence = row_number())
View(vb_usa)
vb_usa <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country","w_player2","w_p2_birthdate", "w_p2_country","l_player1","l_p1_birthdate", "l_p1_country","l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c(  "player1" = "w_player1", "player2"="w_player2" ,"player3" ="l_player1" ,"player4"="l_player2"))
View(vb_usa)
View(vb_matches)
vb_1 <- vb_matches %>%
vb_1 <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country")) %>%
rename(., c("player" = "w_player1", "birthdate" = "w_p1_birthdate", "country" = "w_p1_country"))
vb_1 <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country")) %>%
rename(., c("player" = "w_player1", "birthdate" = "w_p1_birthdate", "country" = "w_p1_country"))
vb_2 <- vb_matches %>%
select(c("w_player2","w_p2_birthdate", "w_p2_country")) %>%
rename(., c("player" = "w_player2", "birthdate" = "w_p2_birthdate", "country" = "w_p2_country"))
vb_usa <- vb_1 %>%
bind_rows(vb_2)
View(vb_usa)
vb_3 <- vb_matches %>%
select(c("l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c("player" = "l_player2", "birthdate" = "l_p2_birthdate", "country" = "l_p2_country"))
vb_4 <- vb_matches %>%
select(c("l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c("player" = "l_player2", "birthdate" = "l_p2_birthdate", "country" = "l_p2_country"))
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4)
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distint(, .keep_all = FALSE)
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE)
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States")
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate))
library(lubridate)
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate))
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate))
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate)) %>%
drop_na()
plot1 <- ggplot(vb_usa) + geom_histogram(aes(x=yday))
plot1
plot1 <- ggplot(vb_usa) + geom_col(aes(x=yday))
plot1
plot1 <- ggplot(vb_usa) + geom_col(aes(x=yday, y = count))
plot1
plot1 <- ggplot(vb_usa) + geom_col(aes(x=yday, y = stat(count))
plot1 <- ggplot(vb_usa) + geom_col(aes(x=yday, y = stat(count)))
plot1
plot1 <- ggplot(vb_usa) + geom_point(aes(x=yday)
plot1 <- ggplot(vb_usa) + geom_point(aes(x=yday))
plot1 <- ggplot(vb_usa) + geom_point(aes(x=yday))
plot1
plot1 <- ggplot(vb_usa) + geom_point(aes(x=month))
plot1
plot1 <- ggplot(vb_usa) + geom_histogram(aes(x=month))
plot1
plot1 <- ggplot(vb_usa) + geom_density(aes(x=month))
plot1
plot1 <- ggplot(vb_usa) + geom_density(aes(x=yday))
plot1
plot1 <- ggplot(vb_usa) + geom_histogram(aes(x=yday))
plot1
plot1 <- ggplot(vb_usa) + geom_histogram(aes(x=yday), bins = 50)
plot1
plot1 <- ggplot(vb_usa) + geom_histogram(aes(x=yday), bins = 30)
plot1
plot1 <- ggplot(vb_usa) + geom_histogram(aes(x=month))
plot1
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate)) %>%
drop_na()
plot1 <- ggplot(vb_usa) + geom_histogram(aes(x=month))
plot1
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate)) %>%
drop_na()
plot1 <- ggplot(vb_usa) + geom_histogram(aes(x=month))
plot1
plot1 <- ggplot(vb_usa) + geom_density(aes(x=month))
plot1
US_humans <- readr::read_csv('https://raw.githubusercontent.com/fivethirtyeight/data/master/births/US_births_2000-2014_SSA.csv')
View(US_humans)
US <- US_humans %>%
mutate(date = make_date(2000, month, date_of_month)) %>%
mutate(yday = yday(date))
View(US_humans)
View(US)
plot1 <- ggplot() + geom_density(data = vb_usam, aes(x=yday)) + geom_density(data = US, aes(x=yday))
plot1 <- ggplot() + geom_density(data = vb_usa, aes(x=yday)) + geom_density(data = US, aes(x=yday))
plot1
#graph
human_bday_plot <- ggplot(human_bdays) + geom_density(aes(x=date, y=vs_avg), stat = 'identity') + geom_hline(yintercept=1) +geom_text(data = data.frame(x = as.Date("2000-07-04"), y = 0.754613951076881,label = "4th of July"), mapping = aes(x = x, y = y, label = label),angle = 0L, lineheight = 1L, hjust = 0.5, vjust = 0.5, colour = "black",family = "sans", fontface = "plain", inherit.aes = FALSE, show.legend = FALSE)
human_bdays <- US_humans %>%
mutate(date = make_date(2000, month, date_of_month)) %>%
group_by(month, date_of_month, date) %>%
summarise(births = sum(births)) %>%
ungroup() %>%
mutate(vs_avg = (births/mean(births)))
#graph
human_bday_plot <- ggplot(human_bdays) + geom_density(aes(x=date, y=vs_avg), stat = 'identity') + geom_hline(yintercept=1) +geom_text(data = data.frame(x = as.Date("2000-07-04"), y = 0.754613951076881,label = "4th of July"), mapping = aes(x = x, y = y, label = label),angle = 0L, lineheight = 1L, hjust = 0.5, vjust = 0.5, colour = "black",family = "sans", fontface = "plain", inherit.aes = FALSE, show.legend = FALSE)
human_bday_plot
plot1 <- ggplot() + geom_density(data = vb_usa, aes(x=yday))
plot1
plot1 <- ggplot() + geom_line(data = vb_usa, aes(x=yday))
plot1
plot1 <- ggplot() + geom_line(data = vb_usa, aes(x=yday,y = stat(count)))
plot1
plot1 <- ggplot() + geom_line(data = vb_usa, mapping = aes(x=yday,y = stat(count)))
plot1
View(vb_usa)
vb_usa <- vb_1 %>%
vb_usa <- vb_1 %>%
vb_usa <- vb_1 %>%
b
vb_1 <- vb_matches %>%
select(c("w_player1","w_p1_birthdate", "w_p1_country")) %>%
rename(., c("player" = "w_player1", "birthdate" = "w_p1_birthdate", "country" = "w_p1_country"))
vb_2 <- vb_matches %>%
select(c("w_player2","w_p2_birthdate", "w_p2_country")) %>%
rename(., c("player" = "w_player2", "birthdate" = "w_p2_birthdate", "country" = "w_p2_country"))
vb_3 <- vb_matches %>%
select(c("l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c("player" = "l_player2", "birthdate" = "l_p2_birthdate", "country" = "l_p2_country"))
vb_4 <- vb_matches %>%
select(c("l_player2","l_p2_birthdate", "l_p2_country")) %>%
rename(., c("player" = "l_player2", "birthdate" = "l_p2_birthdate", "country" = "l_p2_country"))
vb_usa <- vb_1 %>%
vb_usa <- vb_1 %>%
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate)) %>%
drop_na() %>%
group_by(birthdate) %>%
summarize(number = count(birthday))
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate)) %>%
drop_na() %>%
group_by(birthdate) %>%
summarize(number = count(birthdate))
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate)) %>%
drop_na() %>%
group_by(birthdate) %>%
summarize()
View(vb_usa)
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate)) %>%
drop_na() %>%
group_by(yday) %>%
summarize(count = count(yday))
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate)) %>%
drop_na() %>%
group_by(yday) %>%
summarize(n = n())
View(vb_usa)
plot1 <- ggplot() + geom_line(data = vb_usa, aes(x=yday,y = n))
plot1
plot1 <- ggplot() + geom_line(data = vb_usa, aes(x=yday,y = n)) + geom_smooth(data = vb_usa, aes(x=yday,y = n))
plot1
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate)) %>%
drop_na() %>%
group_by(month) %>%
summarize(n = n())
plot1 <- ggplot() + geom_line(data = vb_usa, aes(x=month,y = n)) + geom_smooth(data = vb_usa, aes(x=month,y = n))
plot1
plot1 <- ggplot() + geom_col(data = vb_usa, aes(x=month,y = n)) + geom_smooth(data = vb_usa, aes(x=month,y = n))
plot1
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate)) %>%
drop_na() %>%
group_by(month) %>%
summarize(n = n())
plot1 <- ggplot() + geom_col(data = vb_usa, aes(x=month,y = n))
plot1
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate), yweek = yweek(birthdate)) %>%
drop_na() %>%
group_by(month) %>%
summarize(n = n())
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate), yweek = week(birthdate)) %>%
drop_na() %>%
group_by(month) %>%
summarize(n = n())
vb_usa <- vb_1 %>%
bind_rows(vb_2, vb_3, vb_4) %>%
distinct(., .keep_all = FALSE) %>%
filter(country == "United States") %>%
mutate(month = month(birthdate), day = day(birthdate), yday = yday(birthdate), yweek = week(birthdate)) %>%
drop_na() %>%
group_by(yweek) %>%
summarize(n = n())
plot1 <- ggplot() + geom_col(data = vb_usa, aes(x=yweek,y = n))
plot1
