geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf(data = points_sfc) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 10) +
geom_sf_label_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -10, force = 5) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf(data = points_sfc) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 4) +
geom_sf_label_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -4) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf(data = points_sfc) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
points_sfg <- sf::st_multipoint(as.matrix(expand.grid(x = -126:-110, y = 32:43)), crs = 4326)
points_sfc <- sf::st_sfc(points_sfg, crs = sf::st_crs(CA_Counties))
points_sfg <- sf::st_multipoint(as.matrix(expand.grid(x = -126:-110, y = 32:43)))
points_sfc <- sf::st_sfc(points_sfg, crs = sf::st_crs(CA_Counties))
CA_Plot <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf(data = points_sfc) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
COunties_buffer <- st_buffer(CA_Counties, 50000)
Counties_buffer <- st_buffer(CA_Counties, 50000)
CA_Plot <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf(data = Counties_buffer) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer) +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
Counties_buffer <- st_buffer(CA_Counties, 500000)
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer) +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = NULL, fill = NULL) +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, aes(color = NULL, fill = NULL)) +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, aes(color = 'white', fill = 'white')) +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 4) +
geom_sf_label_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -4) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 4, force = 5) +
geom_sf_label_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -4, force = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 4, force = 10) +
geom_sf_label_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -4, force = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 4, force = 100) +
geom_sf_label_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -4, force = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 4) +
geom_sf_label_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -4, force = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -4, force = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -2, force = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12) +
geom_sf_label_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, force = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, force = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, force = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()+
theme(plot.title = element_text(size=22, family = "Source Sans Pro Semibold")) + theme(text = element_text(size=15, family = "Source Sans Pro"))
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, force = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()+
theme(plot.title = element_text(size=22, family = "Source Sans Pro Semibold")) + theme(text = element_text(size=10, family = "Source Sans Pro"))
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, force = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()+
theme(plot.title = element_text(size=22, family = "Source Sans Pro Semibold")) +
theme(text = element_text(size=1, family = "Source Sans Pro"))
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, force = 5, size = 5,
box.padding = unit(0.5, "lines")) +
xlim(0,2.5) +
ylim(0,2.5) +
theme( plot.title=element_text(size=16,face="bold"),
axis.text=element_text(size=18),
axis.title=element_text(size=20,face="bold"))) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()+
theme(plot.title = element_text(size=22, family = "Source Sans Pro Semibold")) +
theme(text = element_text(size=1, family = "Source Sans Pro"))
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, force = 5, size = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()+
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()+
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 1) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
Counties_buffer <- st_buffer(CA_Counties, 50000)
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12, size = 3) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
Counties_buffer <- st_buffer(CA_Counties, 80000)
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12, size = 3) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12, size = 3, force = 0.5) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12, size = 3, force = 3) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12, size = 3, force = 10) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12, size = 3, force = 30) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12, size = 3, force = 50) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12, size = 3, force = 50) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3, force = 50) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
#Lowest vaccination rate school in each county of California
CA_Vacc <- measles %>%
filter(state == 'California') %>%
filter(!is.na(lat)) %>%
filter(overall != -1) %>%
top_n(-20, mmr)
#Convert into sf point object
CA_Schools <-  st_as_sf(CA_Vacc, coords = c("lng", "lat"), remove= FALSE, agr = "constant", crs = 4326)
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12, size = 3, force = 50) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3, force = 50) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
#Lowest vaccination rate school in each county of California
CA_Vacc <- measles %>%
filter(state == 'California') %>%
filter(!is.na(lat)) %>%
filter(overall != -1) %>%
top_n(-30, mmr)
#Convert into sf point object
CA_Schools <-  st_as_sf(CA_Vacc, coords = c("lng", "lat"), remove= FALSE, agr = "constant", crs = 4326)
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = 12, size = 3, force = 50) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = 12, size = 3, force = 50) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y", nudge_y = 1 ,  hjust = -12, size = 3, force = 50) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3, force = 50) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y",   hjust = -12, size = 3, force = 50) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 1,  hjust = -12, size = 3, force = 50) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_text_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y",   hjust = -12, size = 3, force = 50) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 3,  hjust = -12, size = 3, force = 50) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y",   hjust = -12, size = 3, force = 50) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 3,  hjust = -12, size = 3, force = 50) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
#Lowest vaccination rate school in each county of California
CA_Vacc <- measles %>%
filter(state == 'California') %>%
filter(!is.na(lat)) %>%
filter(overall != -1) %>%
top_n(-15, mmr)
#Convert into sf point object
CA_Schools <-  st_as_sf(CA_Vacc, coords = c("lng", "lat"), remove= FALSE, agr = "constant", crs = 4326)
CA_Plot <- ggplot() +
geom_sf(data = Counties_buffer, color = 'white', fill = 'white') +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf_label_repel(data = subset(CA_Schools, lng < -121),aes(label = name), direction = "y",   hjust = -12, size = 3, force = 50) +
geom_sf_text_repel(data = subset(CA_Schools, lng > -121),aes(label = name), direction = "y", nudge_y = 3,  hjust = -12, size = 3, force = 50) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot
####Data
measles <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-02-25/measles.csv')
#Lowest vaccination rate school in each county of California
CA_Vacc <- measles %>%
filter(state == 'California') %>%
filter(!is.na(lat)) %>%
filter(overall != -1) %>%
filter(mmr <= 90)
#Convert into sf point object
CA_Schools <-  st_as_sf(CA_Vacc, coords = c("lng", "lat"), remove= FALSE, agr = "constant", crs = 4326)
CA_Plot2 <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot2
CA_Plot2 <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2.5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot2
CA_Plot2 <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal()
CA_Plot2
CA_Plot2 <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal() +
coord_sf(datum = NA)
CA_Plot2
#Lowest vaccination rate school in each county of California
CA_Vacc <- measles %>%
filter(state == 'California') %>%
filter(!is.na(lat)) %>%
filter(overall != -1) %>%
filter(mmr <= 95)
#Convert into sf point object
CA_Schools <-  st_as_sf(CA_Vacc, coords = c("lng", "lat"), remove= FALSE, agr = "constant", crs = 4326)
CA_Plot2 <- ggplot() +
CA_Plot2 <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal() +
coord_sf(datum = NA)
CA_Plot2
CA_Plot2 <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal() +
coord_sf(datum = NA)
CA_Plot2
CA_Plot2 <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf(data = subset(CA_Schools, mmr <=90), color = 'purple', size = 2)
CA_Plot2 <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 2) +
geom_sf(data = subset(CA_Schools, mmr <=90), color = 'purple', size = 2) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal() +
coord_sf(datum = NA)
CA_Plot2
CA_Plot2 <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 1.5) +
geom_sf(data = subset(CA_Schools, mmr <=90), color = 'purple', size = 1) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal() +
coord_sf(datum = NA)
CA_Plot2
CA_Plot2 <- ggplot() +
geom_sf(data = CA, fill = 'white') +
geom_sf(data = CA_Schools, color = 'red', size = 1.5) +
geom_sf(data = subset(CA_Schools, mmr <=90), color = 'purple', size = 1.5) +
theme(axis.title=element_blank(),axis.text=element_blank(),axis.ticks=element_blank()) +
theme_minimal() +
coord_sf(datum = NA)
CA_Plot2
install.packages("ggtext")
remotes::install_github("wilkelab/ggtext")
remotes::install_github("wilkelab/ggtext")
remotes::install_github("wilkelab/ggtext")
